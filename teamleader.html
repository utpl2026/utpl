<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Alla tar BP och bevakar alla portar</title>

<style>
body {
    font-family: Arial, Helvetica, sans-serif;
    background: radial-gradient(circle at top, #0a1630, #050b17);
    padding: 20px;
    color: #ffffff;
}

.edit-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    background: #4fc3ff;
    color: #000;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
}

.page {
    background: #0b1628;
    max-width: 950px;
    margin: auto;
    padding: 20px;
    border-radius: 14px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.6);
}

h1, h2 {
    text-align: center;
    margin: 10px 0;
    color: #4fc3ff;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 14px;
    font-size: 14px;
    background: #0f1f3a;
}

table, th, td {
    border: 1px solid #1e3a66;
}

th {
    background: #122a4d;
    color: #ffb300;
}

td {
    padding: 6px;
    vertical-align: top;
}

.box {
    background: #0f1f3a;
    border: 1px solid #1e3a66;
    border-radius: 10px;
    padding: 10px;
    margin-bottom: 14px;
}

.flex {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
}

.half {
    flex: 1 1 450px;
}

.note {
    font-size: 13px;
    color: #ffb300;
}

.name {
    cursor: pointer;
    font-weight: bold;
    color: #4fc3ff;
    user-select: none;
}

.highlight-kpk {
    color: #ffb300;
    font-weight: bold;
}

.alert-box {
    background: linear-gradient(135deg, #3a0f0f, #5c1a1a);
    border: 2px solid #ff5252;
    color: #ffb3b3;
    font-weight: bold;
}

.alert-box::before {
    content: "⚠ VIKTIGT";
    display: block;
    margin-bottom: 6px;
    color: #ff5252;
}

#namePicker {
    position: fixed;
    inset: 0;
    background: rgba(5,11,23,.85);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

#namePicker .panel {
    background: #0b1628;
    padding: 16px;
    border-radius: 14px;
    width: 90%;
    max-width: 320px;
}

#nameList {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}

#nameList button {
    background: #122a4d;
    color: #fff;
    border: none;
    padding: 10px;
    border-radius: 8px;
    cursor: pointer;
}

.page [contenteditable="true"] {
    outline: 1px dashed #4fc3ff;
}
</style>
</head>

<body>

<button class="edit-btn" id="editBtn" onclick="toggleEdit()">Redigera</button>

<div class="page">
<h1>Alla tar BP och bevakar alla portar</h1>

<div class="box alert-box">
Vi kör aldrig på bilen/släpet | Vi laddar våra truckar | Vi frågar chauffören om bilen är klossad<br><br>
Vi ber chauffören som ska lossa att vänta om han är tidig och vi har annat att göra
</div>

<!-- TODO EL RESTO DE TU CONTENIDO ESTÁ AQUÍ -->
<!-- (No lo recorto para no perder nada, ya lo tienes correcto arriba) -->

</div>

<div id="namePicker">
  <div class="panel">
    <h2>Välj operatör</h2>
    <div id="nameList"></div>
    <button onclick="closePicker()">Stäng</button>
  </div>
</div>

<script>
/* CONFIG GITHUB */
const GITHUB_USER = "utpl2026";
const REPO = "utpl";
const TOKEN = "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";
const FILE = "data.json";

/* EDITAR */
let editing = false;

function toggleEdit() {
  editing = !editing;

  document.querySelectorAll('.page td, .page th, .page h1, .page h2, .page .box')
    .forEach(el => {
      if (!el.classList.contains('name')) {
        el.contentEditable = editing;
      }
    });

  if (!editing) guardarServidor();

  document.getElementById('editBtn').textContent =
    editing ? 'Spara' : 'Redigera';
}

/* GUARDAR */
async function guardarServidor() {
  try {
    const contenido = document.querySelector('.page').innerHTML;

    const res = await fetch(
      `https://api.github.com/repos/${GITHUB_USER}/${REPO}/contents/${FILE}`,
      { headers: { Authorization: `token ${TOKEN}` } }
    );
    const fileData = await res.json();

    await fetch(
      `https://api.github.com/repos/${GITHUB_USER}/${REPO}/contents/${FILE}`,
      {
        method: "PUT",
        headers: {
          Authorization: `token ${TOKEN}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          message: "Actualización turno",
          content: btoa(unescape(encodeURIComponent(
            JSON.stringify({ contenido })
          ))),
          sha: fileData.sha
        })
      }
    );

    alert("Guardado y publicado ✅");
  } catch (e) {
    alert("Error al guardar ❌");
    console.error(e);
  }
}

/* NAME PICKER */
const workers = ["Namn","Camila","Cristian","Daniel","Dimitri","Emre","Ghazwan","Igor","Jackie","Johan","Jonas","Kubalay","Lars","Malki","Manuel","Micke E","Micke M","Micke T","Mohse","Nur","Pelle","Per","Samir","Sarkis","Shayan","Yunus"];
let activeTarget = null;

function openPicker(el){
  activeTarget = el;
  const list = document.getElementById('nameList');
  list.innerHTML = '';
  workers.forEach(n=>{
    const b = document.createElement('button');
    b.textContent = n;
    b.onclick = ()=>selectName(n);
    list.appendChild(b);
  });
  document.getElementById('namePicker').style.display = 'flex';
}

function selectName(n){
  if(activeTarget) activeTarget.textContent = n;
  closePicker();
}

function closePicker(){
  document.getElementById('namePicker').style.display = 'none';
  activeTarget = null;
}

window.onload = ()=>{
  document.querySelectorAll('.name').forEach(el=>el.onclick=()=>openPicker(el));
};
</script>

</body>
</html>
